<<<<<<< HEAD
---
title: "Final Project - Instagram Data"
author: "Estrella Hurtado & Alina Valliani"
date: "2024-04-04"
output: html_document
---
## Introduction
Where we got the data
What categories we used. (followers buckets, caption lengths, keyword buckets)


```{r setup, include=TRUE,message=FALSE}
knitr::opts_chunk$set(warning = FALSE,message = FALSE)
library(tidyverse)
library(lubridate)
library(stringr)
library(dplyr)
library(plotly)
```

## Imported Data

```{r}
insta_data <- read_csv("instagram_data.csv")
glimpse(insta_data)
```


# Mutated columns
Created new columns with calculated values
```{r}
new_data<- insta_data %>% mutate(engagement = round((((likes+comments)/followers)*100),digits = 2),
                                 follower_quantile = ntile(followers,4),
                                 engagement_quantile = ntile(engagement,4),
                                 post_timestamp = as_datetime(created_at),
                                 post_time = format(round(post_timestamp,units = "hours"),format = "%H:%M"),caption_length = lengths(strsplit(caption, ' ')))

```

## Mutated data glimpse  
```{r}
glimpse(new_data)
```
## Account Follower Distribution
Insights on the account follower distribution 1 is the lowest, 4 the highest
```{r}
new_data %>% group_by(follower_quantile) %>% summarise(follower_mean = format(round(mean(followers),0),big.mark=','))
```


## Instagram engagement trends

engagement vs. follower count bucket
```{r}
new_data %>% filter(engagement != is.na(engagement)) %>% 
  group_by(follower_quantile) %>% summarise(avg_eng = mean(engagement)) %>% 
  ggplot(aes(x = follower_quantile,y = avg_eng)) +
  geom_line() + labs(x='Follower Count Quartile',y = 'Average Engagement')
```

## Post time vs Engament

```{r}
new_data %>% filter(engagement != is.na(engagement)) %>% group_by(post_time) %>% summarise(mean(engagement),n())
```

> *When do posts get the most engagement?

We see the most engagement between the hours of 5AM, 8AM, 12 PM, 1 PM, 4PM and 5PM, During peak times of the day. This is showing avg engagement% by post local time

```{r}
time_eng <- new_data %>% filter(engagement != is.na(engagement)) %>% group_by(post_time) %>% summarise(eng_mean = round(mean(engagement),1)) %>% 
  ggplot(aes(x = eng_mean,y = post_time,fill = as.factor(post_time))) +
  geom_col(stat = 'identity') +
  scale_x_continuous(labels = waiver()) +
  labs(y = 'Posting Time', x = "Avg Engagement %") +
  scale_fill_manual(values = c('05:00'="tomato",'08:00'="tomato",'12:00'="tomato",'13:00'="tomato",'16:00'="tomato",'17:00'="tomato"), guide = FALSE)

ggplotly(time_eng)
```

##Relationship between caption lengths and engagement

Highest engagement posts include captions with lengths x & y
```{r}
new_data %>% filter(engagement != is.na(engagement)) %>% 
  mutate(caption_bucket = case_when(caption_length < 50 ~"<50",caption_length >=50 & caption_length<100~"50-100",caption_length>=100 & caption_length < 150 ~ "100-150",caption_length>=150 & caption_length < 200 ~ "150-200",caption_length>=200 & caption_length < 250 ~ "200-250",caption_length>=250 & caption_length < 300 ~ "250-300",caption_length>=300 & caption_length < 350 ~ "300-350",caption_length > 350 ~"350+")) %>% group_by(caption_bucket) %>%
  summarise(avg_eng = mean(engagement)) %>% ggplot(aes(x = caption_bucket,y = avg_eng))+geom_point(size = 5) + labs(x = "Caption Length",y = "Average Engagement")+ scale_x_discrete(limits = c("<50","50-100","100-150","150-200","200-250","250-300","300-350","350+"))
```

##Pictures/Videos/Carousel vs. Engagement

Do pictures or videos get more engagement?
Clearly single images get more engagement and carousels get less

```{r}
new_data %>% filter(engagement != is.na(engagement)) %>% mutate(type = case_when(is_video == TRUE & multiple_images == FALSE ~"Video",
                                    is_video == FALSE & multiple_images == FALSE ~ "Picture",
                                    multiple_images == TRUE ~ "Carousel")) %>% 
  group_by(type) %>% summarise(avg_eng = mean(engagement)) %>% 
  ggplot(aes(x = type,y = avg_eng))+
  geom_col() + labs(x = 'Content Type',y = 'Average Engagement')
```

We see pictures get more engagement
```{r}
new_data %>% 
  ggplot(aes(x = likes, y = comments, group = is_video, color = is_video)) + geom_point() +scale_y_log10() + scale_x_log10() + scale_color_manual(name = "Type", labels = c("Picture", "Video"),values = c("blue","red"))
```
