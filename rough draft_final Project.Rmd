---
title: "Final Project - Instagram Data"
author: "Estrella Hurtado & Alina Valliani"
date: "2024-04-04"
output: html_document
---
## Introduction

Our data is derived from Instagram accounts and comes from the website known as Kaggle.com. The data contains usernames, followers, followers, likes, comments, and locations for different accounts. This data is interesting because it has a large sample of different accounts where we can draw conclusions about patterns in engagement scores. In the data, we used some categories, such as followers, buckets, caption lengths, and keyword buckets.  



```{r setup, include=TRUE,message=FALSE}
knitr::opts_chunk$set(warning = FALSE,message = FALSE)
library(tidyverse)
library(lubridate)
library(stringr)
library(dplyr)
library(plotly)
```

## Unfiltered Data

```{r}
insta_data <- read_csv("instagram_data.csv")
glimpse(insta_data)
```


## Mutated columns

We added new columns representing 1 as the lowest followers, 2 and 3 as the average followers and the 4 as the highest followers. 

```{r}
new_data<- insta_data %>% mutate(engagement = round((((likes+comments)/followers)*100),digits = 2),
                                 follower_quantile = ntile(followers,4),
                                 engagement_quantile = ntile(engagement,4),
                                 post_timestamp = as_datetime(created_at),
                                 post_time = format(round(post_timestamp,units = "hours"),format = "%H:%M"),caption_length = lengths(strsplit(caption, ' ')))

```

## Filtered Data  

New columns with new calculated values. 

```{r}
glimpse(new_data)
```


## Reference of Account Followers Distribution 

Insights on the account follower distribution 1 is the lowest, 4 is the highest. 

```{r}
new_data %>% group_by(follower_quantile) %>% summarise(follower_mean = format(round(mean(followers),0),big.mark=','))
```


## Instagram Engagement Trends




### What trends do we see based on posts with the highest engagement? 


Low amount of followers have the highest engagement whereas high amount of followers have the lowest engagement. 



```{r}
new_data %>% filter(engagement != is.na(engagement)) %>% 
  group_by(follower_quantile) %>% summarise(avg_eng = mean(engagement)) %>% 
  ggplot(aes(x = follower_quantile,y = avg_eng)) +
  geom_line() + labs(x='Follower Count Quartile',y = 'Average Engagement')
```


### When do posts get the most engagement?



```{r}
new_data %>% filter(engagement != is.na(engagement)) %>% group_by(post_time) %>% summarise(mean(engagement),n())
```


This is showing avg engagement percent by post local time. 



### Reference of the Post Engagement


We see the most engagement between the hours of 5AM, 8AM, 12 PM, 1 PM, 4PM and 5PM, during peak times of the day. 



```{r}
time_eng <- new_data %>% filter(engagement != is.na(engagement)) %>% group_by(post_time) %>% summarise(eng_mean = round(mean(engagement),1)) %>% 
  ggplot(aes(x = eng_mean,y = post_time,fill = as.factor(post_time))) +
  geom_col(stat = 'identity') +
  scale_x_continuous(labels = waiver()) +
  labs(y = 'Posting Time', x = "Avg Engagement %") +
  scale_fill_manual(values = c('05:00'="tomato",'08:00'="tomato",'12:00'="tomato",'13:00'="tomato",'16:00'="tomato",'17:00'="tomato"), guide = FALSE)

ggplotly(time_eng)
```


### What is the relationship between caption length and engagement?


Highest engagement posts include captions with lengths x & y. 



```{r}
new_data %>% filter(engagement != is.na(engagement)) %>% 
  mutate(caption_bucket = case_when(caption_length < 50 ~"<50",caption_length >=50 & caption_length<100~"50-100",caption_length>=100 & caption_length < 150 ~ "100-150",caption_length>=150 & caption_length < 200 ~ "150-200",caption_length>=200 & caption_length < 250 ~ "200-250",caption_length>=250 & caption_length < 300 ~ "250-300",caption_length>=300 & caption_length < 350 ~ "300-350",caption_length > 350 ~"350+")) %>% group_by(caption_bucket) %>%
  summarise(avg_eng = mean(engagement)) %>% ggplot(aes(x = caption_bucket,y = avg_eng))+geom_point(size = 5) + labs(x = "Caption Length",y = "Average Engagement")+ scale_x_discrete(limits = c("<50","50-100","100-150","150-200","200-250","250-300","300-350","350+"))
```



### From pictures, carousel and videos which one get the most highest engagement? 



Clearly single images get more engagement whereas, carousels get less. 



```{r}
new_data %>% filter(engagement != is.na(engagement)) %>% mutate(type = case_when(is_video == TRUE & multiple_images == FALSE ~"Video",
                                    is_video == FALSE & multiple_images == FALSE ~ "Picture",
                                    multiple_images == TRUE ~ "Carousel")) %>% 
  group_by(type) %>% summarise(avg_eng = mean(engagement)) %>% 
  ggplot(aes(x = type,y = avg_eng))+
  geom_col() + labs(x = 'Content Type',y = 'Average Engagement')
```


### From pictures and videos which one get the most comment and likes? 



We see pictures get more comments and likes than videos. 



```{r}
new_data %>% 
  ggplot(aes(x = likes, y = comments, group = is_video, color = is_video)) + geom_point() +scale_y_log10() + scale_x_log10() + scale_color_manual(name = "Type", labels = c("Picture", "Video"),values = c("blue","red"))
```
